# 基本設計

## 技術スタック

| 項目           | 技術         | 理由                                       |
| -------------- | ------------ | ------------------------------------------ |
| フレームワーク | Vue 3        | 学習コスト低、Composition API で保守性向上 |
| ビルドツール   | Vite         | 高速な開発体験                             |
| 言語           | TypeScript   | 型安全性、リファクタリングしやすい         |
| スタイル       | Scoped CSS   | コンポーネント単位でスタイル管理           |
| ホスティング   | GitHub Pages | 無料、簡単デプロイ                         |

## ディレクトリ構成

```
alcohol-limit/
├── docs/                    # ドキュメント
│   ├── 要件定義.md
│   └── 基本設計.md
├── src/
│   ├── components/          # UIコンポーネント
│   │   ├── LimitInput.vue      # 本数上限入力
│   │   ├── DrinkButton.vue     # 飲むボタン
│   │   ├── DrinkCounter.vue    # 現在の本数表示
│   │   ├── WarningDialog.vue   # 警告ダイアログ
│   │   └── ExplosionEffect.vue # 爆発エフェクト
│   ├── composables/         # ロジック（状態管理）
│   │   └── useDrinkTracker.ts  # 飲酒記録の状態管理
│   ├── types/               # 型定義
│   │   └── index.ts
│   ├── App.vue              # ルートコンポーネント
│   └── main.ts              # エントリーポイント
├── public/
│   └── favicon.ico
├── index.html
├── package.json
├── tsconfig.json
├── vite.config.ts
└── README.md
```

## コンポーネント設計

### 画面構成

```
┌─────────────────────────────────┐
│         今日の上限設定           │
│    ┌─────────────────────┐      │
│    │   [ 3 ] 本まで       │      │
│    └─────────────────────┘      │
├─────────────────────────────────┤
│         現在の状況              │
│                                 │
│        🍺 2 / 3 本              │
│                                 │
│    ┌─────────────────────┐      │
│    │    🍺 飲む！         │      │
│    └─────────────────────┘      │
├─────────────────────────────────┤
│         リセット                │
│    ┌─────────────────────┐      │
│    │    リセット          │      │
│    └─────────────────────┘      │
└─────────────────────────────────┘
```

### コンポーネント責務

| コンポーネント        | 責務                                     |
| --------------------- | ---------------------------------------- |
| `App.vue`             | レイアウト、状態管理のcomposable呼び出し |
| `LimitInput.vue`      | 上限本数の入力UI                         |
| `DrinkCounter.vue`    | 現在の飲んだ本数 / 上限を表示            |
| `DrinkButton.vue`     | 「飲む」ボタン                           |
| `WarningDialog.vue`   | 上限超過時の確認ダイアログ               |
| `ExplosionEffect.vue` | 警告時の爆発アニメーション               |

## 状態管理

Composition API の `composable` パターンで管理（Piniaは過剰なため不使用）

### useDrinkTracker.ts

```typescript
interface DrinkState {
  limit: number       // 今日の上限
  count: number       // 飲んだ本数
  isOverLimit: boolean // 上限超過フラグ
}

// 提供する機能
- setLimit(n: number)     // 上限設定
- drink()                 // 1本飲む
- reset()                 // リセット
- state: DrinkState       // リアクティブな状態
```

## データ永続化

**localStorage** を使用

```typescript
// 保存するデータ
interface StoredData {
  date: string; // "2025-01-15" 形式
  limit: number; // 上限
  count: number; // 飲んだ本数
}
```

- アプリ起動時にlocalStorageから読み込み
- 日付が変わっていたらリセット
- 状態変更時に自動保存

## 警告フロー

```
[飲むボタンクリック]
        │
        ▼
    count < limit ? ─── Yes ──→ count++ → 表示更新
        │
       No
        │
        ▼
  WarningDialog表示
  「本当に飲みますか？」
        │
    ┌───┴───┐
   Yes     No
    │       │
    ▼       ▼
count++   何もしない
爆発エフェクト
背景真っ赤
```

## GitHub Pages デプロイ

### 方法

- `gh-pages` ブランチにビルド成果物をプッシュ
- GitHub Actions で自動化

### vite.config.ts 設定

```typescript
export default defineConfig({
  base: "/alcohol-limit/", // リポジトリ名
  // ...
});
```

## 今後の拡張性考慮

PoC後の拡張を見据えた設計：

- コンポーネント分割により機能追加が容易
- TypeScriptで型安全にリファクタリング可能
- composableパターンでロジック再利用可能
